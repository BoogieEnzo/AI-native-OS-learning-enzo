# 春节学习计划

rCore Tutorial 第七章、第八章学习计划与验收清单。

---

## 第七章：进程间通信与信号

### 学习目标

- **管道（Pipe）**：基于 fd 的进程间通信，父子进程单向数据传递
- **信号（Signal）**：异步事件通知，kill / sigaction / sigprocmask / sigreturn
- **统一 fd 抽象**：文件、管道、标准 I/O 共享同一套 `read/write` 接口

### 源码阅读顺序

| 顺序 | 文件 | 重点问题 |
|------|------|----------|
| 1 | `src/fs.rs` | 为何用 `Fd` 枚举统一文件/管道/标准 I/O？ |
| 2 | `src/main.rs` 的 `impls::IO` | `pipe`、`read`、`write` 如何共享 fd_table？ |
| 3 | `src/process.rs` | 信号状态在 `from_elf`、`fork`、`exec` 中如何继承/重置？ |
| 4 | `src/main.rs` Trap 主循环 | 为何在 syscall 返回前处理信号？处理结果如何影响进程存活？ |
| 5 | `src/main.rs` 的 `impls::Signal` | kill/sigaction/sigprocmask/sigreturn 的内核语义？ |

### DoD 验收标准

- [ ] 能解释为何用统一 `Fd` 枚举承载「文件/管道/标准 IO」
- [ ] 能从代码说明 `pipe` 建立后父子进程如何通过读写端通信
- [ ] 能说明信号的发送、注册、屏蔽、返回四个关键 syscall 语义
- [ ] 能解释「syscall 返回前检查信号」对进程退出路径的影响
- [ ] 能执行 `./test.sh base` 并通过本章基础测试

### 运行与测试

```bash
cd tg-rcore-tutorial/ch7
cargo build
cargo run
./test.sh base
```

---

## 第八章：并发（线程与同步原语）

### 学习目标

- **线程（Thread）**：将进程拆分为资源容器（Process）和执行单元（Thread）
- **同步原语**：Mutex、Semaphore、Condvar，解决多线程竞争问题
- **双层调度**：PThreadManager 同时管理 PID 与 TID

### 源码阅读顺序

| 顺序 | 文件 | 重点问题 |
|------|------|----------|
| 1 | `src/process.rs` | `Process` 与 `Thread` 如何分离资源与执行职责？ |
| 2 | `src/processor.rs` | `PThreadManager` 如何维护 PID/TID 双层关系？ |
| 3 | `src/main.rs` 初始化路径 | `init_thread`、`init_sync_mutex` 如何接入系统？ |
| 4 | `src/main.rs` Trap 主循环 | SEMAPHORE_DOWN/MUTEX_LOCK/CONDVAR_WAIT 返回 -1 时为何转为阻塞态？ |
| 5 | `src/main.rs` 的 `impls::Thread/SyncMutex` | 阻塞 -> 唤醒 -> 重新入队的完整路径？ |

### DoD 验收标准

- [ ] 能清楚区分 `Process`（资源容器）与 `Thread`（执行单元）的职责边界
- [ ] 能说明 `PThreadManager` 如何维护 PID/TID 双层关系
- [ ] 能解释 `thread_create/gettid/waittid` 的核心语义与返回值
- [ ] 能解释阻塞型同步原语中「阻塞 -> 唤醒 -> 重新入队」的完整路径
- [ ] 能执行 `./test.sh base`（练习模式：`./test.sh exercise`）

### 运行与测试

```bash
cd tg-rcore-tutorial/ch8
cargo build
cargo run
./test.sh base
# 练习模式（死锁检测等）
cargo run --features exercise
./test.sh exercise
```

---

## 学习进度

| 章节 | 计划完成 | 实际完成 | 备注 |
|------|----------|----------|------|
| 第七章 | 春节假期 | | |
| 第八章 | 春节假期 | | |
